---
title: "Data analysis"
author: "Mariane Modena"
format: html
---

```{r}
here::i_am("r-101-grade-analysis.Rproj")
library(dplyr)
library(ggplot2)
library(vroom)
```
## Question 1

```{r}
grades <- vroom("grades.csv")
```
## Question 2

```{r}
exam_grades <- 
  grades |>
  summarise('max'=max(Exam, na.rm=TRUE), 'min'=min(Exam, na.rm=TRUE), 'median'=median(Exam, na.rm=TRUE), 'mean'=mean(Exam, na.rm=TRUE))

knitr::kable(exam_grades, caption='Descriptive statistics on the grades received at the exam')
```
## Question 3

```{r}
NA_exam <- 
  grades |>
  filter(is.na(Exam))
```

`r nrow(NA_exam)` students didn't take the exam.

## Question 4

We first compute a dataset with no 'NA' values in the 'Exam' column from the grades dataset. Using this new dataset when plotting the distribution of the Exam grades avoids warnings from ggplot2.

```{r}
No_NA_exam <-
  grades |>
  filter(!is.na(Exam))
```


```{r}
ggplot(No_NA_exam, aes(x=Exam))+
  geom_bar()+
  scale_x_continuous(breaks = scales::pretty_breaks(n = 20))+
  labs(title='Distribution of the grades received at the exam', x='Exam grades' )
```
Note: we could also use a geom density, but it only captures the global shape of the distribution and therefore fails to highlight the lower counts of grades that end with '.5'.

## Question 5 

```{r}
students_per_group <-
  grades |>
  group_by(Group)|>
  summarise('Number of students'=n())
  
knitr::kable(students_per_group)
```


